function getStoreID(){var e=location.href;return e.substring(e.indexOf("?id=")+4)}function loadStoreAddress(){$.ajax({url:"https://cors-anywhere.herokuapp.com/https://www.systembolaget.se/api/assortment/stores/xml",success:function(e){for(var t=getStoreID(),n=e.getElementsByTagName("ButikOmbud"),r=0;r<n.length;r++)if(n[r].childNodes[1].textContent===t){var o=n[r].childNodes[6].textContent.toLowerCase();o=o.charAt(0).toUpperCase()+o.slice(1),document.getElementById("address").innerHTML+=n[r].childNodes[3].textContent+" ",document.getElementById("address").innerHTML+=n[r].childNodes[5].textContent+" ",document.getElementById("address").innerHTML+=o}},datatype:"xml",error:function(){alert("Error: Something went wrong with loading stores: "+status)}})}function buildSearchResultTable(e,t,n){for(var r={name:"Namn",group:"Sort",price:"Pris",drinkSugestion:"Drink förslag"},o=Mustache.render("<tr><th>{{name}}</th><th>{{group}}</th><th>{{price}}</th></tr>",r),d=0;d<t;d++){var i={Name:e[d].childNodes[3].textContent+" "+e[d].childNodes[4].textContent,Varugrupp:e[d].childNodes[10].textContent,Prisinklmoms:e[d].childNodes[5].textContent};"Varugrupp"!=e[d].childNodes[10].nodeName&&(i.Varugrupp=e[d].childNodes[11].textContent),o+=Mustache.render("<tr><td>{{{Name}}}</td><td>{{{Varugrupp}}}</td><td>{{{Prisinklmoms}}}</td></tr>",i)}$("#searchResult").html(o),getDrinkSugestions(n)}function getDrinkSugestions(e){var t=getDrinks(e,3);document.getElementById("drinkSugestions").innerHTML="Drink förslag för "+e+": ";for(var n=0;n<t.drinks.length;n++){var r="drink.html?i="+t.drinks[n].idDrink,o=document.createElement("A"),d=document.createTextNode(t.drinks[n].strDrink+", ");o.appendChild(d),o.setAttribute("href",r),document.getElementById("drinkSugestions").appendChild(o)}}function getDrinks(e,t){var n,r="http://www.thecocktaildb.com/api/json/v1/1/filter.php?i="+e;return $.ajax({url:r,async:!1,success:function(e){n='{"drinks":[';for(var r=".",o=0;o<t;o++){do{var d=Math.floor(Math.random()*e.drinks.length)}while(r.indexOf("."+d+".")>0&&"."!==r);r+=d+".",n+=JSON.stringify(e.drinks[d])}return n+="]}",n=replaceAll(n,"}{","},{")},error:function(e,t,n){alert("något gick fel med API-anslutningen")}}),JSON.parse(n)}function replaceAll(e,t,n){return e.replace(new RegExp(t,"g"),n)}$(document).ready(function(){loadStoreAddress(),document.getElementById("searchDrinkBtn").addEventListener("click",function(){var e=document.getElementById("searchDrinkInput").value;loadStoreInventoryData(e.toLowerCase(),getStoreID())})});